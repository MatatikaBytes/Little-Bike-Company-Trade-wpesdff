version: pipelines/v0.1
name: Weekly trade stock email
schedule: 0 0 9 * * MON
timeout: 60
max_retries: 0
script: |-
  csv=trade-stock.csv

  curl -f $ENDPOINT_URL/workspaces/$WORKSPACE_ID/resources/$csv \
    -H "Authorization: Bearer $AUTH_TOKEN" \
    > $csv

  export SENDGRID_ATTACHMENTS=$csv
  meltano invoke sendgrid
data_components:
- sendgrid
